[[train]]
name = "bdd100k_track_train_os"
type = "BDD100K"
annotations = "data/one_sequence/labels"
data_root = "data/one_sequence/images/"
              
config_path = "box_track"
num_processes = 0
    [train.dataloader]
    skip_empty_samples = true

    [[train.dataloader.transformations]]
    type = "Resize"
    kwargs = {"shape" = [720, 1280]}

    [[train.dataloader.transformations]]
    type = "RandomHorizontalFlip"
    kwargs = {"p" = 0.5}

[[test]]
name = "bdd100k_track_val_os"
type = "BDD100K"
annotations = "data/one_sequence/labels"
data_root = "data/one_sequence/images/"
eval_metrics = ["track"]
config_path = "box_track"
num_processes = 0

[model]
type = "DeepSORT"
dataset = "BDD100K"
max_boxes_num=512
num_instances=108524
prediction_path = "given_predictions/track_predictions_val.json"
category_mapping = {"pedestrian" = 0, "rider" = 1, "car" = 2, "truck" = 3, "bus" = 4, "train" = 5, "motorcycle" = 6, "bicycle" = 7}
    [model.detection]
    type = "D2TwoStageDetector"
    model_base = "faster-rcnn/r50-fpn"
    num_classes = 8
    category_mapping = {"pedestrian" = 0, "rider" = 1, "car" = 2, "truck" = 3, "bus" = 4, "train" = 5, "motorcycle" = 6, "bicycle" = 7}

    [model.track_graph]
    type = "DeepSORTTrackGraph"

    [model.optimizer]
    type = "SGD"
    lr = 0.001
    kwargs = {"momentum" = 0.9}

    [model.lr_scheduler]
    type = "MultiStepLR"
    kwargs = {"milestones" = [9, 11]}

[dataloader]
image_channel_mode = "RGB"

[launch]
samples_per_gpu = 32
workers_per_gpu = 8

[trainer]
max_epochs = 12
log_every_n_steps = 50
check_val_every_n_epoch = 1
num_sanity_val_steps = 0
gpus = 1