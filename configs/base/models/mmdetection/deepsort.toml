[model]
type = "DeepSORT"
dataset = "BDD100K"
prediction_path = "../../../202110/track_predictions_val.json"
category_mapping = {"pedestrian" = 0, "rider" = 1, "car" = 2, "truck" = 3, "bus" = 4, "train" = 5, "motorcycle" = 6, "bicycle" = 7}

    [model.track_graph]
    type = "DeepSORTTrackGraph"
    [model.track_graph.kf_parameters]
    "cov_P0" = [
        [130363.162, 15246.8002, 0.0749263997,3801.96084,705.997987,69.3107798,0.0169660746,251.984314],
        [106299.635, 7621.82331, 0.0265128590, 9957.09368, 879.803991, 46.7733130, 0.0110787403,245.433342],
        [ 86435.4891, 7039.96568, 0.599361209, 5314.91592, 743.454651, 62.8976153, 0.0833401389, 170.516808],
        [78363.6910, 9814.64602, 0.718019111, 11798.9238, 470.574168, 81.9679566, 0.0832222574, 293.063254],
        [72196.8159, 8081.26034, 1.20843169, 16829.6357, 308.926763, 56.9572590, 0.115621987, 278.613360,],
        [25447.04705146, 12229.74292921, 30.33280637, 786.91488908, 289.002658, 10.6413650, 2.61966052, 10.1094497,],
        [126077.476, 10479.8820, 0.181134313, 14591.5600, 1433.82900, 84.3457354, 0.0417226039, 157.237463,],
        [132648.423, 10000.7394, 0.430164913, 3021.86143, 1571.07547, 48.9261851, 0.0378682818, 68.9090661,]
    ]
    "cov_motion_Q" = [
        [95.1002390, 121.688249, 0.0375305405, 409.420166, 95.1002390, 121.688249, 0.0375305405, 409.420166,],
        [93.0169729, 74.6423484, 0.0222534639, 280.491075, 93.0169729, 74.6423484, 0.0222534639, 280.491075,],
        [130.522293, 81.5736135, 0.148145829, 189.263725, 130.522293, 81.5736135, 0.148145829, 189.263725,],
        [103.248631, 124.451954, 0.153643998, 320.258165, 103.248631, 124.451954, 0.153643998, 320.258165,],
        [89.3391012, 94.1702110, 0.225044124, 320.547258, 89.3391012, 94.1702110, 0.225044124, 320.547258,],
        [647.168378, 25.5278075, 6.45178977, 23.5915829, 647.168378, 25.5278075, 6.45178977, 23.5915829,],
        [212.369389, 82.2899899, 0.0616784441, 178.878798, 212.369389, 82.2899899, 0.0616784441, 178.878798,],
        [ 216.815833, 56.0445579, 0.0646074367, 80.8328780, 216.815833, 56.0445579, 0.0646074367, 80.8328780,],
    ]
    "cov_project_R" = [
        [11.5104590, 13.0282011, 0.00586219863, 59.1848444],
        [13.3436723, 35.8695006, 0.00879138301, 148.374241],
        [11.5692674, 7.96198637, 0.0293811571, 34.1893846],
        [23.6716091, 23.6320282, 0.0423234022, 99.6595906],
        [29.6828290, 20.8130628, 0.0740571154, 82.1853481],
        [1306.10802, 9.63054139, 5.99376772, 69.0863395],
        [27.1543578, 29.3202776, 0.0269419035, 82.3861447],
        [13.0619404, 11.9467389, 0.0193958280, 59.0829406],
    ]

    [model.similarity]
    type = "DeepSortSimilarityHead"
    num_instances= 108524
    num_fcs = 1
    fc_out_dim= 128
    max_boxes_num = 512

        [model.similarity.loss_cls]
        type = "CrossEntropyLoss"
        loss_weight = 1.0

        [model.similarity.roi_align_config]
        type = "MultiScaleRoIPooler"
        pooling_op = "RoIAlign"
        resolution = [64, 128]
        strides = [1]
        sampling_ratio = 0